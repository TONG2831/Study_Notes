# CSRF

## 1.CSRF是什么?

> CSRF（Cross Site Request Forgery），跨站点请求伪造。CSRF攻击者在用户已经登录目标网站之后，诱使用户访问一个攻击页面，利用目标网站对用户的信任，以用户身份在攻击页面对目标网站发起伪造用户操作的请求，达到攻击目的。
>
> [Web安全之CSRF攻击](https://www.cnblogs.com/lovesong/p/5233195.html)

## 2.CSRF产生的场景

- 攻击者了解目标网站的请求（包含请求方法、请求路径、请求参数）方式
- 用户访问攻击者的攻击页面

## 3.CSRF的防御

> 防御的基本背景，攻击者在已经了解网站的请求方式的状况下，可以通过直接请求路径或者模拟表单的形式完成`GET`和`POST`请求。
>
> 这时，想要完成CSRF防御，就需要通过增加校验的方式：

1. 验证请求头中`Referer`属性

   `Referer`，记录http请求的来源地址。Referer是浏览器的安全策略，基本情况不能修改，凡是在某些浏览器中可以修改，例如`IE6`。

   优点：简单易行

   缺点：依赖于浏览器，不靠谱

2. token指令

   由服务端生成`token`指令，传递给客户端，客户端请求的形式有两种

   - 添加在请求参数中，get请求放在请求路径后面，表单提交则设置隐藏域“<input type="hidden">”。
   - 自定义请求头属性，服务端验证请求头。

   

   **这里有个重要的问题：服务端生成的token指令如何存放，或者说从服务端生成的token指令中间通过什么形式添加到隐藏域或请求头属性？**

   1. 将token放在cookie中。这种方式有个前提，不存在XSS漏洞或cookie-token为Httponly属性。
   2. 每次请求之前从服务端获取token指令。

   

   

   该方法通过随机生成token来验证，安全性较高，大多数采用此类方法。

3. 验证码

   。。。。